<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>환경 모니터링 시스템</title>
    <link rel="stylesheet" href="style.css">
</head>

<style>
    @import url(https://fonts.googleapis.com/css2?family=Lato&display=swap);

    @import url(https://fonts.googleapis.com/css2?family=Open+Sans&display=swap);

    @import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200);

    @import url(//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css);

    #a, #b, #c {
        display: none;
    }

    #current-time {
        font-family: 'Spoqa Han Sans Neo', 'sans-serif';
        ;
        font-size: 24px;
        font-weight: 600;
        color: rgb(25, 25, 25);
        letter-spacing: 0.5px;
        /* font-weight: 100; */
    }

    #second {
        font-family: 'Spoqa Han Sans Neo', 'sans-serif';
        ;
        font-size: 14px;
        font-weight: 600;
        color: rgb(25, 25, 25);
        letter-spacing: 0.5px;
        /* font-weight: 100; */
    }

    * {
        font-family: 'Spoqa Han Sans Neo', 'sans-serif';
        ;
    }

    *,
    :after,
    :before {
        border: 0 solid #e5e7eb;
        box-sizing: border-box;
    }

    :after,
    :before {
        --tw-content: "";
    }

    :host,
    html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family:
            Open Sans,
            ui-sans-serif,
            system-ui,
            sans-serif,
            Apple Color Emoji,
            Segoe UI Emoji,
            Segoe UI Symbol,
            Noto Color Emoji;
        font-feature-settings: normal;
        font-variation-settings: normal;
        -moz-tab-size: 4;
        tab-size: 4;
        -webkit-tap-highlight-color: transparent;
    }

    body {
        line-height: inherit;
        margin: 0;
    }

    hr {
        border-top-width: 1px;
        color: inherit;
        height: 0;
    }

    abbr:where([title]) {
        text-decoration: underline dotted;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-size: inherit;
        font-weight: inherit;
    }

    a {
        color: inherit;
        text-decoration: inherit;
    }

    b,
    strong {
        font-weight: bolder;
    }

    code,
    kbd,
    pre,
    samp {
        font-family:
            ui-monospace,
            SFMono-Regular,
            Menlo,
            Monaco,
            Consolas,
            Liberation Mono,
            Courier New,
            monospace;
        font-feature-settings: normal;
        font-size: 1em;
        font-variation-settings: normal;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
    }

    sub {
        bottom: -0.25em;
    }

    sup {
        top: -0.5em;
    }

    table {
        border-collapse: collapse;
        border-color: inherit;
        text-indent: 0;
    }

    button,
    input,
    optgroup,
    select,
    textarea {
        color: inherit;
        font-family: inherit;
        font-feature-settings: inherit;
        font-size: 100%;
        font-variation-settings: inherit;
        font-weight: inherit;
        letter-spacing: inherit;
        line-height: inherit;
        margin: 0;
        padding: 0;
    }

    button,
    select {
        text-transform: none;
    }

    button,
    input:where([type="button"]),
    input:where([type="reset"]),
    input:where([type="submit"]) {
        -webkit-appearance: button;
        background-color: transparent;
        background-image: none;
    }

    :-moz-focusring {
        outline: auto;
    }

    :-moz-ui-invalid {
        box-shadow: none;
    }

    progress {
        vertical-align: baseline;
    }

    ::-webkit-inner-spin-button,
    ::-webkit-outer-spin-button {
        height: auto;
    }

    [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
    }

    ::-webkit-search-decoration {
        -webkit-appearance: none;
    }

    ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
    }

    summary {
        display: list-item;
    }

    blockquote,
    dd,
    dl,
    figure,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    hr,
    p,
    pre {
        margin: 0;
    }

    fieldset {
        margin: 0;
    }

    fieldset,
    legend {
        padding: 0;
    }

    menu,
    ol,
    ul {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    dialog {
        padding: 0;
    }

    textarea {
        resize: vertical;
    }

    input::placeholder,
    textarea::placeholder {
        color: #9ca3af;
        opacity: 1;
    }

    [role="button"],
    button {
        cursor: pointer;
    }

    :disabled {
        cursor: default;
    }

    audio,
    canvas,
    embed,
    iframe,
    img,
    object,
    svg,
    video {
        display: block;
        vertical-align: middle;
    }

    img,
    video {
        height: auto;
        max-width: 100%;
    }

    [hidden] {
        display: none;
    }

    *,
    :after,
    :before {
        --tw-border-spacing-x: 0;
        --tw-border-spacing-y: 0;
        --tw-translate-x: 0;
        --tw-translate-y: 0;
        --tw-rotate: 0;
        --tw-skew-x: 0;
        --tw-skew-y: 0;
        --tw-scale-x: 1;
        --tw-scale-y: 1;
        --tw-pan-x: ;
        --tw-pan-y: ;
        --tw-pinch-zoom: ;
        --tw-scroll-snap-strictness: proximity;
        --tw-gradient-from-position: ;
        --tw-gradient-via-position: ;
        --tw-gradient-to-position: ;
        --tw-ordinal: ;
        --tw-slashed-zero: ;
        --tw-numeric-figure: ;
        --tw-numeric-spacing: ;
        --tw-numeric-fraction: ;
        --tw-ring-inset: ;
        --tw-ring-offset-width: 0px;
        --tw-ring-offset-color: #fff;
        --tw-ring-color: rgba(59, 130, 246, 0.5);
        --tw-ring-offset-shadow: 0 0 #0000;
        --tw-ring-shadow: 0 0 #0000;
        --tw-shadow: 0 0 #0000;
        --tw-shadow-colored: 0 0 #0000;
        --tw-blur: ;
        --tw-brightness: ;
        --tw-contrast: ;
        --tw-grayscale: ;
        --tw-hue-rotate: ;
        --tw-invert: ;
        --tw-saturate: ;
        --tw-sepia: ;
        --tw-drop-shadow: ;
        --tw-backdrop-blur: ;
        --tw-backdrop-brightness: ;
        --tw-backdrop-contrast: ;
        --tw-backdrop-grayscale: ;
        --tw-backdrop-hue-rotate: ;
        --tw-backdrop-invert: ;
        --tw-backdrop-opacity: ;
        --tw-backdrop-saturate: ;
        --tw-backdrop-sepia: ;
        --tw-contain-size: ;
        --tw-contain-layout: ;
        --tw-contain-paint: ;
        --tw-contain-style: ;
    }

    ::backdrop {
        --tw-border-spacing-x: 0;
        --tw-border-spacing-y: 0;
        --tw-translate-x: 0;
        --tw-translate-y: 0;
        --tw-rotate: 0;
        --tw-skew-x: 0;
        --tw-skew-y: 0;
        --tw-scale-x: 1;
        --tw-scale-y: 1;
        --tw-pan-x: ;
        --tw-pan-y: ;
        --tw-pinch-zoom: ;
        --tw-scroll-snap-strictness: proximity;
        --tw-gradient-from-position: ;
        --tw-gradient-via-position: ;
        --tw-gradient-to-position: ;
        --tw-ordinal: ;
        --tw-slashed-zero: ;
        --tw-numeric-figure: ;
        --tw-numeric-spacing: ;
        --tw-numeric-fraction: ;
        --tw-ring-inset: ;
        --tw-ring-offset-width: 0px;
        --tw-ring-offset-color: #fff;
        --tw-ring-color: rgba(59, 130, 246, 0.5);
        --tw-ring-offset-shadow: 0 0 #0000;
        --tw-ring-shadow: 0 0 #0000;
        --tw-shadow: 0 0 #0000;
        --tw-shadow-colored: 0 0 #0000;
        --tw-blur: ;
        --tw-brightness: ;
        --tw-contrast: ;
        --tw-grayscale: ;
        --tw-hue-rotate: ;
        --tw-invert: ;
        --tw-saturate: ;
        --tw-sepia: ;
        --tw-drop-shadow: ;
        --tw-backdrop-blur: ;
        --tw-backdrop-brightness: ;
        --tw-backdrop-contrast: ;
        --tw-backdrop-grayscale: ;
        --tw-backdrop-hue-rotate: ;
        --tw-backdrop-invert: ;
        --tw-backdrop-opacity: ;
        --tw-backdrop-saturate: ;
        --tw-backdrop-sepia: ;
        --tw-contain-size: ;
        --tw-contain-layout: ;
        --tw-contain-paint: ;
        --tw-contain-style: ;
    }

    #webcrumbs .mb-12 {
        margin-bottom: 48px;
    }

    #webcrumbs .mb-6 {
        margin-bottom: 24px;
    }

    #webcrumbs .flex {
        display: flex;
    }

    #webcrumbs .grid {
        display: grid;
    }

    #webcrumbs .h-3 {
        height: 12px;
    }

    #webcrumbs .w-3 {
        width: 12px;
    }

    #webcrumbs .w-\[600px\] {
        width: 600px;
    }

    #webcrumbs .grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    #webcrumbs .flex-row {
        flex-direction: row;
    }

    #webcrumbs .flex-col {
        flex-direction: column;
    }

    #webcrumbs .items-end {
        align-items: flex-end;
    }

    #webcrumbs .items-center {
        align-items: center;
    }

    #webcrumbs .justify-center {
        justify-content: center;
    }

    #webcrumbs .justify-between {
        justify-content: space-between;
    }

    #webcrumbs .gap-1 {
        gap: 4px;
    }

    #webcrumbs .gap-2 {
        gap: 8px;
    }

    #webcrumbs .gap-4 {
        gap: 16px;
    }

    #webcrumbs .gap-8 {
        gap: 32px;
    }

    #webcrumbs .rounded-full {
        border-radius: 9999px;
    }

    #webcrumbs .rounded-xl {
        border-radius: 36px;
    }

    #webcrumbs .border-\[0\.5px\] {
        border-width: 0.5px;
    }

    #webcrumbs .border-gray-100 {
        --tw-border-opacity: 1;
        border-color: rgb(243 244 246 / var(--tw-border-opacity));
    }

    #webcrumbs .bg-green-500 {
        --tw-bg-opacity: 1;
        background-color: rgb(34 197 94 / var(--tw-bg-opacity));
    }

    #webcrumbs .bg-red-500 {
        --tw-bg-opacity: 1;
        background-color: rgb(239 68 68 / var(--tw-bg-opacity));
    }

    #webcrumbs .bg-white\/80 {
        background-color: hsla(0, 0%, 100%, 0.8);
    }

    #webcrumbs .bg-yellow-500 {
        --tw-bg-opacity: 1;
        background-color: rgb(234 179 8 / var(--tw-bg-opacity));
    }

    #webcrumbs .p-4 {
        padding: 16px;
    }

    #webcrumbs .p-8 {
        padding: 32px;
    }

    #webcrumbs .text-2xl {
        font-size: 24px;
        line-height: 31.200000000000003px;
    }

    #webcrumbs .text-3xl {
        font-size: 30px;
        line-height: 36px;
    }

    #webcrumbs .text-5xl {
        font-size: 45px;
        line-height: 52.800000000000004px;
    }

    #webcrumbs .text-base {
        font-size: 16px;
        line-height: 25.6px;
    }

    #webcrumbs .font-bold {
        font-weight: 700;
    }

    #webcrumbs .font-medium {
        font-weight: 500;
    }

    #webcrumbs .text-blue-500 {
        --tw-text-opacity: 1;
        color: rgb(59 130 246 / var(--tw-text-opacity));
    }

    #webcrumbs .text-green-500 {
        --tw-text-opacity: 1;
        color: rgb(34 197 94 / var(--tw-text-opacity));
    }

    #webcrumbs .shadow-lg {
        --tw-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
            0 4px 6px -4px rgba(0, 0, 0, 0.1);
        --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color),
            0 4px 6px -4px var(--tw-shadow-color);
        box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000),
            var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    }

    #webcrumbs .backdrop-blur-lg {
        --tw-backdrop-blur: blur(16px);
        -webkit-backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
        backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
    }

    #webcrumbs .transition-colors {
        transition-duration: 0.5s;
        transition-property: color, background-color, border-color,
            text-decoration-color, fill, stroke;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }

    #webcrumbs .transition-opacity {
        transition-duration: 0.5s;
        transition-property: opacity;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }

    #webcrumbs .transition-transform {
        transition-duration: 0.5s;
        transition-property: transform;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }

    #webcrumbs {
        font-family: Open Sans !important;
        font-size: 16px !important;
    }

    #webcrumbs .hover\:scale-110:hover {
        --tw-scale-x: 1.1;
        --tw-scale-y: 1.1;
        transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
    }

    #webcrumbs .hover\:bg-gray-50\/50:hover {
        background-color: rgba(249, 250, 251, 0.5);
    }

    #webcrumbs .hover\:opacity-80:hover {
        opacity: 0.8;
    }

    body {
        line-height: inherit;
        padding: 24px;
        display: flex;
        flex-direction: column;
        min-width: 100vw;
        min-height: 100vh;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #ffffff, #d4d4d4);
    }
</style>

<body>
    <div id="webcrumbs">
        <div class="w-[600px] bg-white/80 backdrop-blur-lg rounded-xl shadow-lg p-8 border-[0.5px] border-gray-100">
            <div class="flex gap-2 mb-6">
                <div class="w-3 h-3 rounded-full bg-red-500 hover:opacity-80 transition-opacity"></div>
                <div class="w-3 h-3 rounded-full bg-yellow-500 hover:opacity-80 transition-opacity"></div>
                <div class="w-3 h-3 rounded-full bg-green-500 hover:opacity-80 transition-opacity"></div>
            </div>
            <div class="flex justify-center items-center gap-2 mb-12">
                <span class="material-symbols-outlined text-4xl mb-2" id="a">sunny</span>
                <span class="material-symbols-outlined text-4xl mb-2" id="b">light_mode</span>
                <span class="material-symbols-outlined text-4xl mb-2" id="c">dark_mode</span>
                <section style="margin: 0; display: flex; justify-content: center; align-items: center;">
                    <span id="current-time" class="text-2xl font-medium">--:--</span>
                    <span id="second" class="text-1xl font-medium"
                        style="padding-top: 6px; padding-left: 3px;">--</span>
                </section>
            </div>
            <div class="grid grid-cols-2 gap-8">
                <!-- 온도 -->
                <div id="temperature-box"
                    class="flex flex-col gap-2 p-4 rounded-xl hover:bg-gray-50/50 transition-colors status-box">
                    <div class="flex items-center justify-center gap-2">
                        <span
                            class="material-symbols-outlined hover:scale-110 transition-transform">device_thermostat</span>
                        <span class="text-base">온도</span>
                    </div>
                    <div class="flex items-end justify-center gap-1">
                        <span id="temperature" class="text-5xl font-bold">--</span>
                        <span class="text-3xl">°C</span>
                    </div>
                </div>

                <!-- 습도 -->
                <div id="humidity-box"
                    class="flex flex-col gap-2 p-4 rounded-xl hover:bg-gray-50/50 transition-colors status-box">
                    <div class="flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined hover:scale-110 transition-transform">water_drop</span>
                        <span class="text-base">습도</span>
                    </div>
                    <div class="flex items-end justify-center gap-1">
                        <span id="humidity" class="text-5xl font-bold">--</span>
                        <span class="text-3xl">%</span>
                    </div>
                </div>

                <!-- 미세먼지 -->
                <div id="pm25-box"
                    class="flex flex-col gap-2 p-4 rounded-xl hover:bg-gray-50/50 transition-colors status-box">
                    <div class="flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined hover:scale-110 transition-transform">air</span>
                        <span class="text-base">공기질</span>
                    </div>
                    <div class="flex items-end justify-center gap-1">
                        <span id="pm25" class="text-5xl font-bold">--</span>
                        <span class="text-3xl">μg/m³</span>
                    </div>
                </div>
                <div class="flex flex-col gap-2 p-4 rounded-xl hover:bg-gray-50/50 transition-colors">
                    <div class="flex items-center justify-center gap-2"> <span
                            class="material-symbols-outlined hover:scale-110 transition-transform">location_on</span>
                        <span class="text-base">위치</span>
                    </div>
                    <section style="margin: 0;">
                        <div class="flex justify-center">경상남도 양산시 물금읍<span class="text-5xl font-bold"></span>
                        </div>
                        <div class="flex justify-center">가촌리 1277-4<span class="text-5xl font-bold"></span>
                        </div>
                    </section>
                </div>
            </div>
        </div>
</body>

<script>
    function updateData() {
        fetch('/get_data')  // 서버의 /get_data API 호출
            .then(response => response.json())
            .then(data => {
                // ✅ 현재 시간 업데이트
                const current_time = `${data.ampm} ${data.hour}:${data.minute}`;
                const second = `${data.second}`;
                document.getElementById('current-time').textContent = current_time;
                document.getElementById('second').textContent = second;

                // ✅ 시간 아이콘 업데이트
                let hour = ~~data.hour_24; // 받은 데이터에서 24시간제 시간변수를 정수로 저장
                if (6 < hour && hour < 12) {
                    document.getElementById("a").style.display = "block";
                    document.getElementById("b").style.display = "none";
                    document.getElementById("c").style.display = "none";
                } else if (12 < hour && hour < 18) {
                    document.getElementById("a").style.display = "none";
                    document.getElementById("b").style.display = "block";
                    document.getElementById("c").style.display = "none";
                } else {
                    document.getElementById("a").style.display = "none";
                    document.getElementById("b").style.display = "none";
                    document.getElementById("c").style.display = "block";
                }

                // ✅ 온도 업데이트
                const temperature = data.temperature ?? 'N/A';
                document.getElementById('temperature').textContent = `${temperature}`;
                const tempBox = document.getElementById('temperature-box');

                let alpha = 0.3;  // 투명도 고정

                if (temperature !== 'N/A') {
                    let red = 100, green = 255, blue = 150;

                    let redIntensity = Math.min(1, (temperature - 25) / 15); // 40°C에서 빨강 증가
                    let blueIntensity = Math.min(1, (25 - temperature) / 25); // 0°C에서 파랑 증가

                    red = Math.round(100 + redIntensity * (255 - 100));
                    blue = Math.round(150 + blueIntensity * (255 - 150));

                    let greenReduction = Math.max(redIntensity, blueIntensity);
                    green = Math.round(255 - greenReduction * (255 - 100));

                    tempBox.style.backgroundColor = `rgba(${red}, ${green}, ${blue}, ${alpha})`;
                }

                // ✅ 습도 업데이트
                const humidity = data.humidity ?? 'N/A';
                document.getElementById('humidity').textContent = `${humidity}`;
                const humidityBox = document.getElementById('humidity-box');

                if (humidity !== 'N/A') {
                    let hum_alpha = (humidity / 100) * 0.3;
                    humidityBox.style.backgroundColor = `rgba(100, 150, 255, ${hum_alpha})`;
                }

                // ✅ 미세먼지 업데이트
                const pm25 = data.pm25 ?? 'N/A';
                document.getElementById('pm25').textContent = `${pm25}`;
                const pm25Box = document.getElementById('pm25-box');

                if (pm25 !== 'N/A') {
                    let pm25_alpha = (pm25 / 100) * 0.3;
                    pm25Box.style.backgroundColor = `rgba(100, 150, 255, ${pm25_alpha})`;
                }


            })
            .catch(error => {
                console.error('데이터를 가져오는 데 오류가 발생했습니다:', error);
            });
    }

    // ✅ 초기 데이터 업데이트 및 1초마다 갱신
    updateData();
    setInterval(updateData, 1000);

</script>

</html>